<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å | –í–∏–Ω–æ–≥—Ä–∞–¥ –°–∞–Ω—å–æ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 600px;
        }
        
        .sidebar {
            background: #f8f9fa;
            padding: 30px;
            border-right: 1px solid #eaeaea;
        }
        
        .content {
            padding: 30px;
        }
        
        .token-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        
        .nav {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 10px;
        }
        
        .nav-link {
            display: block;
            padding: 12px 20px;
            background: white;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .nav-link:hover {
            background: #667eea;
            color: white;
            border-left-color: #764ba2;
        }
        
        .nav-link.active {
            background: #667eea;
            color: white;
            border-left-color: #764ba2;
        }
        
        .hidden {
            display: none;
        }
        
        .grape-card {
            border: 1px solid #eaeaea;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            background: #f8f9fa;
        }
        
        .grape-card img {
            max-width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #eaeaea;
            padding-bottom: 10px;
        }
        
        .tab {
            padding: 10px 20px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s;
        }
        
        .tab:hover {
            background: #f0f0f0;
            color: #333;
        }
        
        .tab.active {
            background: #667eea;
            color: white;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-top: 1px solid #eaeaea;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                border-right: none;
                border-bottom: 1px solid #eaeaea;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üçá –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å–∞–π—Ç–∞ "–í–∏–Ω–æ–≥—Ä–∞–¥"</h1>
            <p class="subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ä—Ç–∞–º–∏ –≤–∏–Ω–æ–≥—Ä–∞–¥–∞</p>
        </header>
        
        <div class="main-content">
            <aside class="sidebar">
                <ul class="nav">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-tab="token">üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-tab="add">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ä—Ç</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-tab="edit">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ä—Ç–∞</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-tab="upload">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</a>
                    </li>
                </ul>
                
                <div class="token-section">
                    <h3>–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å</h3>
                    <div id="token-status">
                        <p style="color: #dc3545; margin: 10px 0;">‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</p>
                    </div>
                    <button class="btn btn-secondary" onclick="clearToken()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω</button>
                </div>
                
                <div style="margin-top: 30px; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
                    <h4>üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h4>
                    <ol style="padding-left: 20px; margin-top: 10px;">
                        <li>–í—Å—Ç–∞–≤—å GitHub —Ç–æ–∫–µ–Ω</li>
                        <li>–î–æ–±–∞–≤—å –Ω–æ–≤—ã–π —Å–æ—Ä—Ç</li>
                        <li>–°–æ—Ö—Ä–∞–Ω–∏ –Ω–∞ GitHub</li>
                    </ol>
                </div>
            </aside>
            
            <main class="content">
                <div class="tabs">
                    <button class="tab active" data-tab="token">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞</button>
                    <button class="tab" data-tab="add">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ä—Ç</button>
                    <button class="tab" data-tab="edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="tab" data-tab="upload">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ</button>
                </div>
                
                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞ -->
                <div id="tab-token" class="tab-content">
                    <h2>üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub —Ç–æ–∫–µ–Ω–∞</h2>
                    <p>–î–ª—è —Ä–∞–±–æ—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –Ω—É–∂–µ–Ω Personal Access Token —Å –ø—Ä–∞–≤–∞–º–∏ <code>repo</code></p>
                    
                    <div class="form-group">
                        <label for="github-token">GitHub Personal Access Token:</label>
                        <input type="password" id="github-token" placeholder="ghp_–≤–∞—à_—Ç–æ–∫–µ–Ω_–∑–¥–µ—Å—å">
                        <small style="color: #666; margin-top: 5px; display: block;">
                            –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ
                        </small>
                    </div>
                    
                    <button class="btn" onclick="saveToken()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω</button>
                    
                    <div id="token-help" style="margin-top: 30px; padding: 20px; background: #e7f3ff; border-radius: 10px;">
                        <h3>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω?</h3>
                        <ol style="margin-top: 10px; padding-left: 20px;">
                            <li>–ó–∞–π–¥–∏ –≤ GitHub Settings ‚Üí Developer settings ‚Üí Personal access tokens</li>
                            <li>–ù–∞–∂–º–∏ "Generate new token (classic)"</li>
                            <li>–í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∞: <code>repo</code> (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º)</li>
                            <li>–°–∫–æ–ø–∏—Ä—É–π —Ç–æ–∫–µ–Ω –∏ –≤—Å—Ç–∞–≤—å –≤—ã—à–µ</li>
                        </ol>
                    </div>
                </div>
                
                <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ä—Ç–∞ -->
                <div id="tab-add" class="tab-content hidden">
                    <h2>üçá –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–æ—Ä—Ç –≤–∏–Ω–æ–≥—Ä–∞–¥–∞</h2>
                    
                    <div class="form-group">
                        <label for="grape-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ—Ä—Ç–∞:</label>
                        <input type="text" id="grape-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∏—à–º–∏—à –õ—É—á–∏—Å—Ç—ã–π">
                    </div>
                    
                    <div class="form-group">
                        <label for="grape-image">–ò–º—è —Ñ–∞–π–ª–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏:</label>
                        <input type="text" id="grape-image" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: kishmish.jpg">
                        <small style="color: #666;">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∑–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É –Ω–∞ GitHub –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="grape-description">–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Ä—Ç–∞:</label>
                        <textarea id="grape-description" placeholder="–û–ø–∏—à–∏—Ç–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–æ—Ä—Ç–∞, —Å—Ä–æ–∫ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏—è, –≤–∫—É—Å..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="grape-details">–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                        <textarea id="grape-details" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏–∏, —É—Ö–æ–¥–µ –∏ —Ç.–¥."></textarea>
                    </div>
                    
                    <button class="btn" onclick="addNewGrape()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ä—Ç –Ω–∞ —Å–∞–π—Ç</button>
                    
                    <div id="preview" style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px; display: none;">
                        <h3>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</h3>
                        <div id="preview-content"></div>
                    </div>
                </div>
                
                <!-- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
                <div id="tab-edit" class="tab-content hidden">
                    <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ä—Ç–æ–≤</h2>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ—Ä—Ç–æ–≤ —Å —Å–∞–π—Ç–∞...</p>
                    <div id="grape-list"></div>
                    <button class="btn" onclick="loadGrapesFromSite()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ä—Ç–∞ —Å —Å–∞–π—Ç–∞</button>
                </div>
                
                <!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ -->
                <div id="tab-upload" class="tab-content hidden">
                    <h2>üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–∞ GitHub</h2>
                    
                    <div class="form-group">
                        <label for="image-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                        <input type="file" id="image-file" accept="image/*">
                    </div>
                    
                    <div class="form-group">
                        <label for="image-name">–ò–º—è —Ñ–∞–π–ª–∞ –Ω–∞ GitHub:</label>
                        <input type="text" id="image-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: new_grape_photo.jpg">
                    </div>
                    
                    <button class="btn" onclick="uploadImage()">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
                    
                    <div style="margin-top: 30px;">
                        <h3>–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</h3>
                        <div id="image-list" style="margin-top: 15px;">
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...</p>
                        </div>
                        <button class="btn btn-secondary" onclick="loadImages()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                    </div>
                </div>
                
                <div id="status" class="status"></div>
            </main>
        </div>
        
        <footer>
            <p>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Å–∞–π—Ç–∞ –æ –≤–∏–Ω–æ–≥—Ä–∞–¥–µ | –¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ</p>
            <p style="font-size: 0.9rem; margin-top: 5px;">–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Ä—Ç–∞ —Å–∞–π—Ç –æ–±–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã</p>
        </footer>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const REPO_OWNER = 'karpenko0706-arch';
        const REPO_NAME = 'sano';
        const SITE_URL = 'https://karpenko0706-arch.github.io/sano/';
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        let githubToken = '';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadToken();
            setupTabs();
            setupNavigation();
            updateTokenStatus();
        });
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–±–æ–≤
        function setupTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Ç–∞–±–æ–≤
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`tab-${tabId}`).classList.remove('hidden');
                });
            });
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function setupNavigation() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Å—ã–ª–∫—É
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–∞–±
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
                    
                    document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add('active');
                    document.getElementById(`tab-${tabId}`).classList.remove('hidden');
                });
            });
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–∫–µ–Ω –∏–∑ localStorage
        function loadToken() {
            const savedToken = localStorage.getItem('github_token');
            if (savedToken) {
                githubToken = savedToken;
                document.getElementById('github-token').value = savedToken;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω
        function saveToken() {
            const tokenInput = document.getElementById('github-token').value.trim();
            
            if (!tokenInput) {
                showStatus('–í–≤–µ–¥–∏—Ç–µ GitHub —Ç–æ–∫–µ–Ω!', 'error');
                return;
            }
            
            if (!tokenInput.startsWith('ghp_') && !tokenInput.startsWith('github_pat_')) {
                showStatus('–¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å ghp_ –∏–ª–∏ github_pat_', 'error');
                return;
            }
            
            githubToken = tokenInput;
            localStorage.setItem('github_token', tokenInput);
            updateTokenStatus();
            showStatus('‚úÖ –¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ!', 'success');
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
            testToken();
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω
        function clearToken() {
            localStorage.removeItem('github_token');
            githubToken = '';
            document.getElementById('github-token').value = '';
            updateTokenStatus();
            showStatus('–¢–æ–∫–µ–Ω —É–¥–∞–ª–µ–Ω –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞', 'success');
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ç–æ–∫–µ–Ω–∞
        function updateTokenStatus() {
            const tokenStatus = document.getElementById('token-status');
            
            if (githubToken) {
                // –ü–æ–∫–∞–∑–∞—Ç—å —á–∞—Å—Ç–∏—á–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                const maskedToken = githubToken.substring(0, 10) + '...' + githubToken.substring(githubToken.length - 4);
                tokenStatus.innerHTML = `
                    <p style="color: #28a745; margin: 10px 0;">‚úÖ –¢–æ–∫–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω</p>
                    <p style="font-size: 0.9rem; color: #666; margin: 5px 0;">${maskedToken}</p>
                `;
            } else {
                tokenStatus.innerHTML = '<p style="color: #dc3545; margin: 10px 0;">‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</p>';
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
        async function testToken() {
            if (!githubToken) return;
            
            try {
                const response = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const userData = await response.json();
                    showStatus(`‚úÖ –¢–æ–∫–µ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç! –ü—Ä–∏–≤–µ—Ç, ${userData.login}!`, 'success');
                } else {
                    showStatus('‚ùå –¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω', 'error');
                }
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞', 'error');
            }
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–æ—Ä—Ç –≤–∏–Ω–æ–≥—Ä–∞–¥–∞
        async function addNewGrape() {
            if (!githubToken) {
                showStatus('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub —Ç–æ–∫–µ–Ω!', 'error');
                return;
            }
            
            const name = document.getElementById('grape-name').value.trim();
            const image = document.getElementById('grape-image').value.trim();
            const description = document.getElementById('grape-description').value.trim();
            const details = document.getElementById('grape-details').value.trim();
            
            if (!name || !description) {
                showStatus('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Ä—Ç–∞!', 'error');
                return;
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–≤—å—é
            showPreview(name, image, description);
            
            try {
                showStatus('üîÑ –ó–∞–≥—Ä—É–∂–∞—é —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É...', 'success');
                
                // 1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π index.html
                const fileResponse = await fetch(
                    `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/index.html`,
                    {
                        headers: {
                            'Authorization': `token ${githubToken}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );
                
                if (!fileResponse.ok) {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å index.html');
                }
                
                const fileData = await fileResponse.json();
                const currentContent = atob(fileData.content);
                
                // 2. –°–æ–∑–¥–∞—Ç—å HTML –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ä—Ç–∞
                const newGrapeHTML = createGrapeHTML(name, image, description, details);
                
                // 3. –ù–∞–π—Ç–∏ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
                let updatedContent = '';
                const searchPattern = /<div class="row">/g;
                const match = searchPattern.exec(currentContent);
                
                if (match) {
                    // –ù–∞–π—Ç–∏ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–π —Ç–µ–≥ </div> –¥–ª—è —ç—Ç–æ–≥–æ row
                    let pos = match.index;
                    let depth = 0;
                    let inRow = false;
                    
                    for (let i = pos; i < currentContent.length; i++) {
                        if (currentContent.substr(i, 17) === '<div class="row">') {
                            depth++;
                            inRow = true;
                            i += 16;
                        } else if (currentContent.substr(i, 6) === '</div>') {
                            depth--;
                            if (inRow && depth === 0) {
                                // –ù–∞—à–ª–∏ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–π —Ç–µ–≥ –¥–ª—è row
                                updatedContent = currentContent.substring(0, i) + newGrapeHTML + currentContent.substring(i);
                                break;
                            }
                        }
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ row, –¥–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º </section>
                if (!updatedContent) {
                    const sectionEnd = currentContent.indexOf('</section>', currentContent.indexOf('tiles'));
                    if (sectionEnd !== -1) {
                        updatedContent = currentContent.substring(0, sectionEnd) + newGrapeHTML + currentContent.substring(sectionEnd);
                    } else {
                        throw new Error('–ù–µ –Ω–∞–π–¥–µ–Ω —Ä–∞–∑–¥–µ–ª –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–æ–≤');
                    }
                }
                
                // 4. –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ GitHub
                const encodedContent = btoa(unescape(encodeURIComponent(updatedContent)));
                
                const updateResponse = await fetch(
                    `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/index.html`,
                    {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${githubToken}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: `–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Å–æ—Ä—Ç –≤–∏–Ω–æ–≥—Ä–∞–¥–∞: ${name}`,
                            content: encodedContent,
                            sha: fileData.sha
                        })
                    }
                );
                
                if (updateResponse.ok) {
                    showStatus(`‚úÖ –°–æ—Ä—Ç "${name}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω! –°–∞–π—Ç –æ–±–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã.`, 'success');
                    
                    // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
                    document.getElementById('grape-name').value = '';
                    document.getElementById('grape-image').value = '';
                    document.getElementById('grape-description').value = '';
                    document.getElementById('grape-details').value = '';
                    
                    // –°–∫—Ä—ã—Ç—å –ø—Ä–µ–≤—å—é
                    document.getElementById('preview').style.display = 'none';
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–æ—Ä—Ç–æ–≤
                    setTimeout(loadGrapesFromSite, 2000);
                } else {
                    const errorData = await updateResponse.json();
                    throw new Error(errorData.message || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                }
                
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                console.error(error);
            }
        }
        
        // –°–æ–∑–¥–∞—Ç—å HTML –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ä—Ç–∞
        function createGrapeHTML(name, image, description, details) {
            const imageSrc = image ? `images/${image}` : 'images/pic02.jpg';
            const fullDescription = details ? `${description}<br><br>${details}` : description;
            
            return `
                <div class="col-4 col-6-medium col-12-small">
                    <section class="box">
                        <a href="#" class="image featured"><img src="${imageSrc}" alt="${name}" /></a>
                        <header>
                            <h3>${name}</h3>
                        </header>
                        <p>${fullDescription}</p>
                        <footer>
                            <ul class="actions">
                                <li><a href="#" class="button alt">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a></li>
                            </ul>
                        </footer>
                    </section>
                </div>
            `;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–≤—å—é
        function showPreview(name, image, description) {
            const previewContent = document.getElementById('preview-content');
            const imageSrc = image ? `images/${image}` : 'images/pic02.jpg';
            
            previewContent.innerHTML = `
                <div class="grape-card">
                    <div style="background: #667eea; color: white; padding: 10px; border-radius: 8px; margin-bottom: 15px;">
                        <h3 style="margin: 0;">${name}</h3>
                    </div>
                    <div style="background: #eaeaea; height: 150px; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
                        <span style="color: #666;">üì∑ ${image || '—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞'}</span>
                    </div>
                    <p>${description}</p>
                    <button class="btn" style="background: #6c757d; padding: 8px 16px; font-size: 14px;">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                </div>
            `;
            
            document.getElementById('preview').style.display = 'block';
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ä—Ç–∞ —Å —Å–∞–π—Ç–∞
        async function loadGrapesFromSite() {
            try {
                showStatus('üîÑ –ó–∞–≥—Ä—É–∂–∞—é —Å–æ—Ä—Ç–∞ —Å —Å–∞–π—Ç–∞...', 'success');
                
                const response = await fetch(SITE_URL);
                const html = await response.text();
                
                // –ü–∞—Ä—Å–∏–º HTML –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Ä—Ç–æ–≤
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const grapeCards = doc.querySelectorAll('.box');
                
                const grapeList = document.getElementById('grape-list');
                grapeList.innerHTML = '';
                
                if (grapeCards.length === 0) {
                    grapeList.innerHTML = '<p>–°–æ—Ä—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
                    return;
                }
                
                grapeCards.forEach((card, index) => {
                    const title = card.querySelector('h3')?.textContent || `–°–æ—Ä—Ç ${index + 1}`;
                    const description = card.querySelector('p')?.textContent || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è';
                    const image = card.querySelector('img')?.src || '';
                    
                    const grapeCard = document.createElement('div');
                    grapeCard.className = 'grape-card';
                    grapeCard.innerHTML = `
                        <h3>${title}</h3>
                        <p>${description.substring(0, 100)}${description.length > 100 ? '...' : ''}</p>
                        <button class="btn btn-secondary" onclick="editGrape(${index})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    `;
                    
                    grapeList.appendChild(grapeCard);
                });
                
                showStatus(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${grapeCards.length} —Å–æ—Ä—Ç–æ–≤`, 'success');
                
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ä—Ç–æ–≤', 'error');
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        async function loadImages() {
            if (!githubToken) {
                showStatus('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub —Ç–æ–∫–µ–Ω!', 'error');
                return;
            }
            
            try {
                showStatus('üîÑ –ó–∞–≥—Ä—É–∂–∞—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...', 'success');
                
                const response = await fetch(
                    `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/images`,
                    {
                        headers: {
                            'Authorization': `token ${githubToken}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );
                
                if (response.ok) {
                    const images = await response.json();
                    const imageList = document.getElementById('image-list');
                    
                    imageList.innerHTML = '';
                    
                    if (images.length === 0) {
                        imageList.innerHTML = '<p>–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</p>';
                        return;
                    }
                    
                    const imageGrid = document.createElement('div');
                    imageGrid.style.display = 'grid';
                    imageGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(150px, 1fr))';
                    imageGrid.style.gap = '15px';
                    imageGrid.style.marginTop = '15px';
                    
                    images.forEach(img => {
                        if (img.type === 'file' && /\.(jpg|jpeg|png|gif)$/i.test(img.name)) {
                            const imgDiv = document.createElement('div');
                            imgDiv.style.textAlign = 'center';
                            imgDiv.innerHTML = `
                                <div style="background: #eaeaea; height: 100px; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px;">
                                    <span style="color: #666;">üì∑</span>
                                </div>
                                <small style="font-size: 0.8rem;">${img.name}</small>
                                <br>
                                <button onclick="useImage('${img.name}')" style="background: none; border: none; color: #667eea; cursor: pointer; font-size: 0.8rem; margin-top: 5px;">
                                    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                                </button>
                            `;
                            imageGrid.appendChild(imgDiv);
                        }
                    });
                    
                    imageList.appendChild(imageGrid);
                    showStatus(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${images.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`, 'success');
                } else {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                }
                
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π', 'error');
            }
        }
        
        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        function useImage(imageName) {
            document.getElementById('grape-image').value = imageName;
            document.querySelector('.nav-link[data-tab="add"]').click();
            showStatus(`‚úÖ –í—ã–±—Ä–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${imageName}`, 'success');
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ GitHub
        async function uploadImage() {
            if (!githubToken) {
                showStatus('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub —Ç–æ–∫–µ–Ω!', 'error');
                return;
            }
            
            const fileInput = document.getElementById('image-file');
            const imageName = document.getElementById('image-name').value.trim();
            
            if (!fileInput.files.length) {
                showStatus('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏!', 'error');
                return;
            }
            
            if (!imageName) {
                showStatus('–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞!', 'error');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = async function(e) {
                try {
                    showStatus('üîÑ –ó–∞–≥—Ä—É–∂–∞—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...', 'success');
                    
                    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ base64
                    const base64Content = e.target.result.split(',')[1];
                    
                    const response = await fetch(
                        `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/images/${imageName}`,
                        {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${githubToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                message: `–î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${imageName}`,
                                content: base64Content
                            })
                        }
                    );
                    
                    if (response.ok) {
                        showStatus(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ "${imageName}" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!`, 'success');
                        document.getElementById('image-file').value = '';
                        document.getElementById('image-name').value = '';
                        setTimeout(loadImages, 2000);
                    } else {
                        const errorData = await response.json();
                        throw new Error(errorData.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
                    }
                } catch (error) {
                    showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                }
            };
            
            reader.readAsDataURL(file);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ä—Ç–∞ (–∑–∞–≥–ª—É—à–∫–∞)
        function editGrape(index) {
            showStatus('–§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...', 'success');
        }
    </script>
</body>
</html>
